
RewriteEngine on

RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^ %{REQUEST_SCHEME}://%1%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} !=localhost
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 

# This is for languages
RewriteRule ^(en|nl|..)/(.*)$ $2?lang=$1 [QSA,DPI]

# And this is for the items
RewriteRule ^([^/]+)/p/([-0-9]*)(/.*/([0-9]*))?/?$ $1$3?page=$2 [QSA,DPI]
RewriteRule ^([^/]+)/book/([-0-9]*)/?$ $1?id=$2 [QSA,DPI]
RewriteRule ^([^/]+)/event/([-0-9]*)/?$ $1?id=$2 [QSA,DPI]
RewriteRule ^([^/]+)/people/([-0-9]*)/?$ $1?id=$2 [QSA,DPI]
RewriteRule ^([^/]+)/location/([-0-9]*)/?$ $1?id=$2 [QSA,DPI]
RewriteRule ^([^/]+)/special/([-0-9]*)/?$ $1?id=$2 [QSA,DPI]
RewriteRule ^([^/]+)/map/([-0-9]*)/?$ $1?id=$2 [QSA,DPI]

# Making sure files and scripts are linked to correctly
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}\/web/$1 -f
RewriteRule ^(.*)$ /web/$1 [QSA]

# Making sure things are redirected to php files
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}\/web/$1\.php -f
RewriteRule ^(.*)$ /web/$1.php [QSA]